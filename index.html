<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nos RÃ©alisations â€” Carrousels infinis</title>
  <style>
    @font-face { font-family: 'Engravers'; src: url('Police Engravers.ttf') format('truetype'); }
    @font-face { font-family: 'TT Lakes'; src: url('Police TTLakes.ttf') format('truetype'); }

    body {
      font-family:'TT Lakes',sans-serif;
      margin:0; padding:0;
      text-align:center;
      color:white;
      background-image: url('Photo outil-plaquette-carbure-brase.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
      min-height:100vh;
      overflow-y: auto;
    }

    .title {
      top: 20px;
      margin-bottom: 20px;
      left:0;
      width:100%; 
      padding:12px 0;
      font-family:'Engravers'; 
      font-size:28px;
      background: rgba(227,6,19,1); 
      z-index:100; 
      font-weight:bold;
      animation: pulsate 2s ease-in-out infinite;
    }

    .logo-container {
      position: fixed; 
      bottom:10px; 
      left:50%;
      transform: translateX(-50%);
      z-index:20;
      background: rgba(255,255,255,0.85);
      border-radius:15px; 
      padding:6px; 
      max-width:400px; 
      width:92%;
      border:1px solid rgba(0,0,0,0.12);
    }

    #logoBF{ width:100%; height:auto; display:block; }

    /* ðŸ‘‰ On ajoute une marge haute suffisante pour que le titre ne chevauche rien */
    .content { 
      padding-top:100px; /* espace pour le titre fixe */
      padding-bottom:200px; 
    }

    .section { margin: 36px 0; }

    .section h2 {
      font-family:'Engravers';
      font-size:25px;
      color: black;
      display: flex;
      background: rgba(255,255,255,0.5); 
      padding:0px 16px; 
      border-radius:8px;
      margin-bottom: 5px;
    }

    /* CARROUSEL */
    .carousel {
      width: 97.5%;
      display: flex;
      margin: 0 auto;
      justify-content: flex-start;
      gap: 10px;
      padding: 5px 15px;
      box-sizing: border-box;
      overflow-x: auto;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .carousel::-webkit-scrollbar{ display:none; }

    /* BOX FIXE */
    .categorie {
      flex: 0 0 140px !important;
      width: 140px !important;
      height: 100px !important;
      flex-shrink: 0;
      box-sizing: border-box;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 2px 6px 20px rgba(0,0,0,0.45);
      transform: scale(0.92);
      opacity: 0.6;
      transition: transform 220ms ease, opacity 220ms ease;
      scroll-snap-align: center;
      background: #222;
      position: relative;
      cursor: pointer;
    }

    .categorie img{ width:100%; height:100%; object-fit:cover; display:block; filter:brightness(.82); }
    .categorie.active { transform: scale(1.08); opacity: 1; }

    .overlay {
      position:absolute; 
      inset:0;
      display:flex; 
      align-items:center; 
      justify-content:center;
      font-family:'Engravers'; 
      color:white; 
      text-align:center;
      background: linear-gradient(to bottom, rgba(0,0,0,0.25), rgba(0,0,0,0.35));
      padding:10px; 
      box-sizing:border-box;
    }

    @media (max-width:720px){
      .categorie { flex:0 0 70%; width:70%; }
    }

    @keyframes pulsate {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body>

  <h2 class="title">DÃ©couvrez nos rÃ©alisations</h2>

  <div class="content">
    <div class="section">
      <h2>AffÃ»tage</h2>
      <div class="carousel" id="c-affutage">
        <a class="categorie" href="Sous page fraises carbure.html"><img src="Photo fraise HSS.jpg" alt=""><div class="overlay">Fraises HSS</div></a>
        <a class="categorie" href="Sous page forets HSS.html"><img src="Photo foret facettes HSS.jpg" alt=""><div class="overlay">Forets HSS</div></a>
        <a class="categorie" href="Sous page circulaires.html"><img src="Photo circulaire carbure.jpg" alt=""><div class="overlay">Circulaires</div></a>
      </div>
    </div>

    <div class="section">
      <h2>Fabrication</h2>
      <div class="carousel" id="c-fabrication">
        <a class="categorie" href="Sous page fraises carbure.html"><img src="Photo fraise carbure.jpg" alt=""><div class="overlay">Fraises carbure</div></a>
        <a class="categorie" href="Sous page forets carbure.html"><img src="Photo foret facettes carbure.jpg" alt=""><div class="overlay">Forets carbure</div></a>
      </div>
    </div>

    <div class="section">
      <h2>Fourniture</h2>
      <div class="carousel" id="c-fourniture">
        <a class="categorie" href="Sous page autre HSS.html"><img src="Photo foret facettes HSS.jpg" alt=""><div class="overlay">Autres HSS</div></a>
      </div>
    </div>
  </div>

  <div class="logo-container"><img id="logoBF" src="Photo Logo BFOSP.png" alt="Logo BF"></div>

  <script>
  function initPracticalInfiniteCarousel(carousel, minRepeatFactor = 20) {
    const origItems = Array.from(carousel.querySelectorAll('.categorie'));
    if (!origItems.length) return;

    function prepare() {
      const visible = carousel.clientWidth || window.innerWidth;
      const targetWidth = visible * minRepeatFactor;

      origItems.forEach(it => {
        it.style.flex = '0 0 140px';
        it.style.width = '140px';
      });

      while (carousel.scrollWidth < targetWidth) {
        origItems.forEach(it => {
          const clone = it.cloneNode(true);
          clone.removeAttribute('id');
          clone.style.flex = '0 0 140px';
          clone.style.width = '140px';
          carousel.appendChild(clone);
        });
      }

      attachCenterListener();
    }

    function attachCenterListener() {
      let ticking = false;
      function onScroll() {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            updateActiveCenter();
            ticking = false;
          });
          ticking = true;
        }
      }
      carousel.addEventListener('scroll', onScroll, { passive: true });
      updateActiveCenter();
      window.addEventListener('resize', () => {
        clearTimeout(carousel._resizeTO);
        carousel._resizeTO = setTimeout(updateActiveCenter, 120);
      });
    }

    function updateActiveCenter() {
      const centerX = carousel.scrollLeft + carousel.clientWidth / 2;
      let closest = null;
      let minDist = Infinity;
      const items = Array.from(carousel.querySelectorAll('.categorie'));
      items.forEach(item => {
        const itemLeft = item.offsetLeft;
        const itemCenter = itemLeft + item.offsetWidth / 2;
        const dist = Math.abs(centerX - itemCenter);
        if (dist < minDist) { minDist = dist; closest = item; }
        item.classList.remove('active');
      });
      if (closest) closest.classList.add('active');
    }

    prepare();
  }

  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.carousel').forEach(car => {
      initPracticalInfiniteCarousel(car, 20);
    });
  });
  </script>

</body>
</html>
